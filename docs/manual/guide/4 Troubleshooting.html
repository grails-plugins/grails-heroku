<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>4 Troubleshooting 1.0</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <ul>
        <li>
            <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                <a href="../guide/index.html" class="button">Table of contents</a>

                <div id="nav-summary-childs" style="display:none;">
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/1%20Introduction%20to%20the%20Heroku%20Plugin.html"><strong>1</strong><span>Introduction to the Heroku Plugin</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/2%20Usage.html"><strong>2</strong><span>Usage</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/3%20Tutorials.html"><strong>3</strong><span>Tutorials</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../guide/4%20Troubleshooting.html"><strong>4</strong><span>Troubleshooting</span></a>
                    </div>
                    
                </div>
            </div>
        </li>
        <li class="separator selected">
            <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
        </li>
    </ul>
</div>
<div id="header">
    <div class="images clearfix">
        
        
    </div>
    <p>Heroku Integration</p>
</div>


<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/3%20Tutorials.html">&lt;&lt; <strong>3</strong><span>Tutorials</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                


                <div class="project">
                    <h1>4 Troubleshooting - Reference Documentation</h1>

                    <p><strong>Authors:</strong> Burt Beckwith</p>

                    <p><strong>Version:</strong> 1.0</p>

                    
                </div>

                

                

<h1 id="4 Troubleshooting">4 Troubleshooting</h1>
<h4>Logging</h4><p class="paragraph"/>Set the log level of the <code>heroku</code>, <code>cloud-support</code>, and/or <code>memcached</code> plugin classes to debug to view status messages while deploying if you're having issues:<p class="paragraph"/><div class="code"><pre>log4j = &#123;
   &#8230;
   debug 'grails.plugin.heroku',
         'grails.plugin.memcached',
         'grails.plugin.cloudsupport'
   &#8230;
&#125;</pre></div><p class="paragraph"/><h4>console and dbconsole plugins</h4><p class="paragraph"/>The <a href="http://grails.org/plugin/console" target="blank">console</a> and <a href="http://grails.org/plugin/dbconsole" target="blank">dbconsole</a> plugins are very helpful in diagnosing issues. The console plugin allows you to run arbitrary Groovy code from a web-based console (similar to the Grails/Groovy Swing-based console) and the dbconsole plugin exposes the H2 database's web-based database console (the H2 database console is available in Grails 2.0 by default, so you only need the plugin in pre-2.0 apps). The great thing about H2's database console is that it doesn't work for just H2 - it works for any JDBC database you have a driver for.<p class="paragraph"/>Add a reference to the console plugin in <code>BuildConfig.groovy</code>:<p class="paragraph"/><div class="code"><pre>plugins &#123;
   &#8230;
   compile ':console:1.0.1'
&#125;</pre></div><p class="paragraph"/>and if you're using 1.3.7 add a reference to the dbconsole plugin:<p class="paragraph"/><div class="code"><pre>plugins &#123;
   &#8230;
   compile ':dbconsole:1.1'
&#125;</pre></div><p class="paragraph"/>If you're using 2.0 you just need to enable it in the production environment since by default it's only enabled in development mode; enable it with the <code>grails.dbconsole.enabled</code> attribute in the production section of <code>Config.groovy</code>:<p class="paragraph"/><div class="code"><pre>production &#123;
   &#8230;
   grails.dbconsole.enabled = <span class="java&#45;keyword">true</span>
   &#8230;
&#125;</pre></div><p class="paragraph"/><blockquote class="warning">
These plugins are very dangerous if left exposed to the public. Be sure to guard them with security if you use them.
</blockquote><p class="paragraph"/>One issue you'll see is that it's tricky to know how to connect to your PostgreSQL database from the database console. You can use the console plugin to inspect the config settings, but it's more convenient to add this code to your application's <code>BootStrap.groovy</code>:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> grails.plugin.heroku.PostgresqlServiceInfo<p class="paragraph"/>class BootStrap &#123;<p class="paragraph"/>   def init = &#123; servletContext &#45;&#62;
      <span class="java&#45;object">String</span> DATABASE_URL = <span class="java&#45;object">System</span>.getenv('DATABASE_URL')
      <span class="java&#45;keyword">if</span> (DATABASE_URL) &#123;
         <span class="java&#45;keyword">try</span> &#123;
            PostgresqlServiceInfo info = <span class="java&#45;keyword">new</span> PostgresqlServiceInfo()
            println <span class="java&#45;quote">"&#110;PostgreSQL service ($DATABASE_URL): url='$info.url', "</span> +
                    <span class="java&#45;quote">"user='$info.username', password='$info.password'&#110;"</span>
         &#125;
         <span class="java&#45;keyword">catch</span> (e) &#123;
            println <span class="java&#45;quote">"Error occurred parsing DATABASE_URL: $e.message"</span>
         &#125;
      &#125;
   &#125;
&#125;</pre></div><p class="paragraph"/>One the application starts up you can view the output by running<p class="paragraph"/><div class="code"><pre>$ heroku logs</pre></div><p class="paragraph"/>You can also add a link to the database console that will automatically log you in using the plugin's taglib (replace the inner text with whatever you want to display as the link text):<p class="paragraph"/><div class="code"><pre>&#60;h:dbconsoleLink&#62;Database Console (autologin)&#60;/h:dbconsoleLink&#62;</pre></div><p class="paragraph"/>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/3%20Tutorials.html">&lt;&lt; <strong>3</strong><span>Tutorials</span></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>


<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-16219500-1']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
</body>
</html>
